{% extends "layout.html" %}
{% block content %}
<div class="container user-guide">
    <div class="row">
        <div class="col-md-3">
            <!-- Navigation Sidebar -->
            <div class="sticky-top" style="top: 80px;">
                <div class="card">
                    <div class="card-header bg-steel text-white">
                        <h4>UMR Writer Guide</h4>
                    </div>
                    <div class="card-body">
                        <nav id="guide-nav" class="nav flex-column">
                            <a class="nav-link" href="#getting-started">Getting Started</a>
                            <a class="nav-link" href="#project-workflow">Project Workflow</a>
                            <a class="nav-link" href="#account-page">Account Page</a>
                            <a class="nav-link" href="#project-page">Project Page</a>
                            <a class="nav-link" href="#sentence-annotation">Sentence-Level Annotation</a>
                            <a class="nav-link" href="#document-annotation">Document-Level Annotation</a>
                            <a class="nav-link" href="#search">Search Functionality</a>
                            <a class="nav-link" href="#updates">Updates & Announcements</a>
                            <a class="nav-link" href="#sample-files">Sample Files</a>
                        </nav>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="col-md-9">
            <!-- Welcome Section -->
            <div class="jumbotron">
                <h1 class="display-4">Welcome to UMR Writer 3.0</h1>
                <p class="lead">A web application for UMR (Uniform Meaning Representation) annotation.</p>
                <hr class="my-4">
                <p>This guide will help you navigate through the features and functionalities of the UMR Writer 3.0.</p>
                
                <div class="mt-4 p-3 bg-light border rounded">
                    <h5><i class="fas fa-bug"></i> Feedback & Support</h5>
                    <p>I welcome bug reports and feature requests. I will respond within 24 hours. You can:</p>
                    <ul>
                        <li><strong>Raise an issue</strong> on the <a href="https://github.com/jinzhao3611/umr-annotation-tool" target="_blank">UMR GitHub page</a></li>
                        <li><strong>Send an email</strong> to <a href="mailto:jinzhao@brandeis.edu">jinzhao@brandeis.edu</a></li>
                    </ul>
                    <p class="mb-0">Thank you for your support in improving UMR Writer.</p>
                </div>
            </div>
            
            <!-- Getting Started Section -->
            <section id="getting-started" class="mb-5">
                <div class="card">
                    <div class="card-header bg-steel text-white">
                        <h2>Getting Started</h2>
                    </div>
                    <div class="card-body">
                        <h4>Register and Login</h4>
                        <p>To begin using UMR Writer, you'll need to:</p>
                        <ol>
                            <li>Click on the <strong>Register</strong> link in the top navigation bar</li>
                            <li>Fill in your information to create an account</li>
                            <li>Once registered, use the <strong>Login</strong> link to access your account</li>
                        </ol>
                        <p>All annotation work requires you to be logged in to your account.</p>
                    </div>
                </div>
            </section>
            
            <!-- Project Workflow Section -->
            <section id="project-workflow" class="mb-5">
                <div class="card">
                    <div class="card-header bg-steel text-white">
                        <h2>Project Workflow</h2>
                    </div>
                    <div class="card-body">
                        <p>UMR Writer organizes annotation work into projects. Here's the typical workflow:</p>
                        <ol>
                            <li>Create or join a project</li>
                            <li>Check out documents for annotation</li>
                            <li>Complete sentence-level annotations</li>
                            <li>Complete document-level annotations</li>
                            <li>Submit your work for quality control</li>
                        </ol>
                    </div>
                </div>
            </section>
            
            <!-- Account Page Section -->
            <section id="account-page" class="mb-5">
                <div class="card">
                    <div class="card-header bg-steel text-white">
                        <h2>Account Page</h2>
                    </div>
                    <div class="card-body">
                        <p>Your account page serves as your dashboard and displays:</p>
                        <ul>
                            <li>All projects you are a member of</li>
                            <li>Quick access to your projects by clicking on their names</li>
                            <li>Preview of documents within your account</li>
                            <li>Association between documents and projects</li>
                        </ul>
                        <p>This is your starting point for all annotation activities after logging in.</p>
                    </div>
                </div>
            </section>
            
            <!-- Project Page Section -->
            <section id="project-page" class="mb-5">
                <div class="card">
                    <div class="card-header bg-steel text-white">
                        <h2>Project Page</h2>
                    </div>
                    <div class="card-body">
                        <h4>Creating a New Project</h4>
                        <ul>
                            <li>Each project supports files in a single language only</li>
                            <li>Language-specific framefiles are automatically installed upon project creation</li>
                        </ul>
                        
                        <h4>Project Navigation</h4>
                        <p>Navigate through project features using tabs on the left panel:</p>
                        
                        <div class="accordion" id="projectFeaturesAccordion">
                            <!-- Documents Tab -->
                            <div class="card">
                                <div class="card-header" id="headingDocuments">
                                    <h5 class="mb-0">
                                        <button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapseDocuments" aria-expanded="true" aria-controls="collapseDocuments">
                                            Documents Tab
                                        </button>
                                    </h5>
                                </div>
                                <div id="collapseDocuments" class="collapse show" aria-labelledby="headingDocuments" data-parent="#projectFeaturesAccordion">
                                    <div class="card-body">
                                        <ul>
                                            <li>Preview initial documents available for annotation</li>
                                            <li>Check out documents for annotation</li>
                                            <li>View which annotator has checked out specific documents</li>
                                            <li>Admins can delete initial documents (this also removes related annotations and quality control documents)</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- My Checked-out Documents Tab -->
                            <div class="card">
                                <div class="card-header" id="headingCheckedOut">
                                    <h5 class="mb-0">
                                        <button class="btn btn-link collapsed" type="button" data-toggle="collapse" data-target="#collapseCheckedOut" aria-expanded="false" aria-controls="collapseCheckedOut">
                                            My Checked-out Documents Tab
                                        </button>
                                    </h5>
                                </div>
                                <div id="collapseCheckedOut" class="collapse" aria-labelledby="headingCheckedOut" data-parent="#projectFeaturesAccordion">
                                    <div class="card-body">
                                        <ul>
                                            <li>Access your annotations here</li>
                                            <li>Override existing annotations by uploading a document with an identical name and format using the "Override Document" button</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Administrative Functions -->
                            <div class="card">
                                <div class="card-header" id="headingAdmin">
                                    <h5 class="mb-0">
                                        <button class="btn btn-link collapsed" type="button" data-toggle="collapse" data-target="#collapseAdmin" aria-expanded="false" aria-controls="collapseAdmin">
                                            Administrative Functions
                                        </button>
                                    </h5>
                                </div>
                                <div id="collapseAdmin" class="collapse" aria-labelledby="headingAdmin" data-parent="#projectFeaturesAccordion">
                                    <div class="card-body">
                                        <ul>
                                            <li><strong>Upload Documents:</strong> Admins upload initial annotation documents here</li>
                                            <li><strong>Update Lexicon:</strong> Feature pending for UMR Writer 3.0</li>
                                            <li><strong>Add and Delete Members:</strong> Only admins manage project membership</li>
                                            <li><strong>Check Statistics:</strong> View annotation progress by members</li>
                                            <li><strong>Change Settings:</strong> Modify document names and other project settings</li>
                                            <li><strong>Change Lattice Settings:</strong> Customize annotation dropdown menus based on language needs</li>
                                            <li><strong>Change Privacy Settings:</strong> Feature pending for future version</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Quality Control -->
                            <div class="card">
                                <div class="card-header" id="headingQC">
                                    <h5 class="mb-0">
                                        <button class="btn btn-link collapsed" type="button" data-toggle="collapse" data-target="#collapseQC" aria-expanded="false" aria-controls="collapseQC">
                                            Quality Control Features
                                        </button>
                                    </h5>
                                </div>
                                <div id="collapseQC" class="collapse" aria-labelledby="headingQC" data-parent="#projectFeaturesAccordion">
                                    <div class="card-body">
                                        <ul>
                                            <li><strong>Submit to Quality Control:</strong> Annotators submit finished annotations for review</li>
                                            <li><strong>Adjudicate:</strong> Compare two annotation files using AnCast integration and review evaluation metrics</li>
                                            <li><strong>Add New Frames and Rolesets:</strong> Feature pending for UMR Writer 3.0</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- Sentence-Level Annotation Section -->
            <section id="sentence-annotation" class="mb-5">
                <div class="card">
                    <div class="card-header bg-steel text-white">
                        <h2>Sentence-Level Annotation</h2>
                    </div>
                    <div class="card-body">
                        <h4>Interface Overview</h4>
                        <p>The sentence-level annotation interface features a two-column display:</p>
                        <ul>
                            <li><strong>Left panel:</strong> Navigate between sentences and view interactive annotations</li>
                            <li><strong>Right panel:</strong> Document info, quick actions, temporary branch storage, and alignments</li>
                        </ul>
                        
                        <h4>Key Features</h4>
                        <ul>
                            <li><strong>Sentence Navigation:</strong> Click sentences directly or use previous/next buttons (`<-`/`->`)</li>
                            <li><strong>In-Place Editing:</strong> Enable edit mode to directly modify relations (highlighted blue) and attribute values (highlighted green)</li>
                            <li><strong>Branch Management:</strong> Delete, move, or add branches via right-click context menu (with edit mode OFF)</li>
                            <li><strong>Annotation Types:</strong> Annotate root nodes, abstract concepts, discourse concepts, reification roles, lexicalized concepts, MWEs, named entities, quoted strings, numbers, and reentrancies</li>
                            <li><strong>Temporary Branch Storage:</strong> Store branches temporarily to reuse across sentences, viewable in the right panel</li>
                            <li><strong>Alignment Handling:</strong> Alignments auto-generated with edits. Manual alignment required when using temporary branches or numeric abstract concepts</li>
                            <li><strong>Export Annotations:</strong> Save all annotations of this documentlocally</li>
                        </ul>
                    </div>
                </div>
            </section>
            
            <!-- Document-Level Annotation Section -->
            <section id="document-annotation" class="mb-5">
                <div class="card">
                    <div class="card-header bg-steel text-white">
                        <h2>Document-Level Annotation</h2>
                    </div>
                    <div class="card-body">
                        <h4>Interface Overview</h4>
                        <p>The document-level annotation interface features a three-column display:</p>
                        <ul>
                            <li><strong>Left column:</strong> Sentence-level annotations</li>
                            <li><strong>Middle column:</strong> Current document-level annotation</li>
                            <li><strong>Right column:</strong> Document info, navigation, and annotation menu</li>
                        </ul>
                        
                        <h4>Working with Triples</h4>
                        <ul>
                            <li><strong>Add Triples:</strong> Add temporal, modal, or coreference triples via the annotation menu in the right column</li>
                            <li><strong>Delete Triples:</strong> Delete triples directly from the middle column via right-click</li>
                            <li><strong>Save Work:</strong> Remember to save annotations frequently to prevent data loss</li>
                            <li><strong>Export Annotations:</strong> Save all annotations of this document locally</li>
                        </ul>
                    </div>
                </div>
            </section>
            
            <!-- Search Functionality Section -->
            <section id="search" class="mb-5">
                <div class="card">
                    <div class="card-header bg-steel text-white">
                        <h2>Search Functionality</h2>
                    </div>
                    <div class="card-body">
                        <p>UMR Writer offers powerful search capabilities:</p>
                        <ul>
                            <li>Search tokens, concepts, or relations at sentence or document levels</li>
                            <li>View comprehensive statistics on search results</li>
                            <li>Filter search results by various criteria</li>
                        </ul>
                        <p>This functionality is particularly useful for finding patterns across annotations or locating specific examples.</p>
                    </div>
                </div>
            </section>
            
            <!-- Updates & Announcements Section -->
            <section id="updates" class="mb-5">
                <div class="card">
                    <div class="card-header bg-steel text-white">
                        <h2>Updates & Announcements</h2>
                    </div>
                    <div class="card-body">
                        <p>Check the Posts section for:</p>
                        <ul>
                            <li>Latest updates about UMR Writer 3.0</li>
                            <li>Feature announcements</li>
                            <li>Important changes to the application</li>
                            <li>Community announcements</li>
                        </ul>
                    </div>
                </div>
            </section>
            
            <!-- Sample Files Section -->
            <section id="sample-files" class="mb-5">
                <div class="card">
                    <div class="card-header bg-steel text-white">
                        <h2>File Formats Accepted by UMR Writer 3.0</h2>
                    </div>
                    <div class="card-body">
                        <p>UMR Writer only supports the format in UMR 2.0 data release.</p>
                        <p>Both uploaded and exported files are in UMR 2.0 format.</p>
                    </div>
                </div>
            </section>
        </div>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Highlight active section in sidebar as user scrolls
        const sections = document.querySelectorAll('section');
        const navLinks = document.querySelectorAll('#guide-nav a');
        
        window.addEventListener('scroll', function() {
            let current = '';
            
            sections.forEach(section => {
                const sectionTop = section.offsetTop;
                const sectionHeight = section.clientHeight;
                if(pageYOffset >= (sectionTop - 150)) {
                    current = section.getAttribute('id');
                }
            });
            
            navLinks.forEach(link => {
                link.classList.remove('active');
                if(link.getAttribute('href').substring(1) === current) {
                    link.classList.add('active');
                }
            });
        });
        
        // Smooth scrolling for navigation links
        document.querySelectorAll('#guide-nav a').forEach(anchor => {
            anchor.addEventListener('click', function(e) {
                e.preventDefault();
                const targetId = this.getAttribute('href');
                document.querySelector(targetId).scrollIntoView({
                    behavior: 'smooth'
                });
            });
        });
    });
</script>

<style>
    .user-guide .card-header.bg-steel {
        background-color: #5f788a;
    }
    
    .user-guide .nav-link.active {
        background-color: #5f788a;
        color: white;
    }
    
    .user-guide section {
        scroll-margin-top: 100px;
    }
    
    .user-guide .accordion .btn-link {
        color: #5f788a;
        text-decoration: none;
        width: 100%;
        text-align: left;
    }
    
    .user-guide .accordion .btn-link:hover,
    .user-guide .accordion .btn-link:focus {
        text-decoration: none;
    }
    
    .user-guide .jumbotron {
        background-color: #f8f9fa;
        border-left: 5px solid #5f788a;
    }
</style>
{% endblock content %}

{% block scripts %}
<!-- Additional JavaScript for the user guide page can be added here -->
{% endblock scripts %}